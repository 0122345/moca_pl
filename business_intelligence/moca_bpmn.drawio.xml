<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2025-11-24T18:00:00.000Z" agent="chatgpt" version="20.4.3" type="device">
  <diagram id="full_system_diag" name="full_system.bpmn">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Pool: Frontend Actors (contains Rider & Driver lanes) -->
        <mxCell id="pool_frontend" value="Frontend Actors" style="swimlane;horizontal=0;startSize=30;rounded=0;fillColor=#ffffff;strokeColor=#000000;swimlaneFillColor=#f7f7f7;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="1200" height="450" as="geometry"/>
        </mxCell>

        <!-- Lane: Rider -->
        <mxCell id="lane_rider" value="Rider" style="swimlane;horizontal=1;startSize=40;rounded=0;fillColor=#ffffff;strokeColor=#7f8c8d;" vertex="1" parent="pool_frontend">
          <mxGeometry x="0" y="0" width="1200" height="220" as="geometry"/>
        </mxCell>

        <!-- Lane: Driver -->
        <mxCell id="lane_driver" value="Driver" style="swimlane;horizontal=1;startSize=40;rounded=0;fillColor=#ffffff;strokeColor=#7f8c8d;" vertex="1" parent="pool_frontend">
          <mxGeometry x="0" y="220" width="1200" height="230" as="geometry"/>
        </mxCell>

        <!-- Pool: Backend Services (Auth, Matchmaking, Tracking, Messaging, Payment) -->
        <mxCell id="pool_backend" value="Backend Services" style="swimlane;horizontal=0;startSize=30;rounded=0;fillColor=#ffffff;strokeColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="20" y="490" width="1200" height="560" as="geometry"/>
        </mxCell>

        <!-- Lanes inside Backend -->
        <mxCell id="lane_auth" value="Authentication / JWT" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_backend">
          <mxGeometry x="0" y="0" width="1200" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="lane_match" value="Matchmaking / Routing" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_backend">
          <mxGeometry x="0" y="100" width="1200" height="120" as="geometry"/>
        </mxCell>

        <mxCell id="lane_tracking" value="Tracking Service" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_backend">
          <mxGeometry x="0" y="220" width="1200" height="120" as="geometry"/>
        </mxCell>

        <mxCell id="lane_messaging" value="Messaging / Notifications" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_backend">
          <mxGeometry x="0" y="340" width="1200" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="lane_payment" value="Payment Gateway Adapter" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_backend">
          <mxGeometry x="0" y="450" width="1200" height="110" as="geometry"/>
        </mxCell>

        <!-- Sample activities in Rider lane -->
        <mxCell id="act_request_ride" value="Request Ride (Enter pickup/dropoff, choose vehicle)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2c3e50;fillColor=#ecf0f1;" vertex="1" parent="lane_rider">
          <mxGeometry x="40" y="50" width="300" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="act_view_driver" value="View Driver ETA & Track" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2c3e50;fillColor=#ecf0f1;" vertex="1" parent="lane_rider">
          <mxGeometry x="380" y="50" width="260" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="act_confirm_payment" value="Confirm Payment / Rate Driver" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2c3e50;fillColor=#ecf0f1;" vertex="1" parent="lane_rider">
          <mxGeometry x="700" y="50" width="320" height="60" as="geometry"/>
        </mxCell>

        <!-- Sample activities in Driver lane -->
        <mxCell id="act_go_online" value="Driver: Go Online (Request availability)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#34495e;fillColor=#f6f8f9;" vertex="1" parent="lane_driver">
          <mxGeometry x="40" y="260" width="300" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="act_receive_request" value="Receive Ride Request / Accept or Reject" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#34495e;fillColor=#f6f8f9;" vertex="1" parent="lane_driver">
          <mxGeometry x="380" y="260" width="300" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="act_navigate_pickup" value="Navigate to Pickup (Live Tracking)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#34495e;fillColor=#f6f8f9;" vertex="1" parent="lane_driver">
          <mxGeometry x="720" y="260" width="300" height="60" as="geometry"/>
        </mxCell>

        <!-- Backend activities: Auth -->
        <mxCell id="act_authenticate" value="Authenticate User / Issue Daily JWToken" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#16a085;fillColor=#ecf9f7;" vertex="1" parent="lane_auth">
          <mxGeometry x="40" y="520" width="360" height="60" as="geometry"/>
        </mxCell>

        <!-- Matchmaking -->
        <mxCell id="act_matchmaking" value="Matchmaking: Find Nearest Driver / Score Candidates" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#27ae60;fillColor=#ecfaef;" vertex="1" parent="lane_match">
          <mxGeometry x="420" y="620" width="420" height="60" as="geometry"/>
        </mxCell>

        <!-- Tracking -->
        <mxCell id="act_update_location" value="Ingest Driver GPS → Update ETA / Route Optimization" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2980b9;fillColor=#eef6fb;" vertex="1" parent="lane_tracking">
          <mxGeometry x="40" y="740" width="420" height="60" as="geometry"/>
        </mxCell>

        <!-- Messaging -->
        <mxCell id="act_messaging" value="Deliver Messages & Notifications (Pickup ETA, Alerts)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#8e44ad;fillColor=#f5eefb;" vertex="1" parent="lane_messaging">
          <mxGeometry x="480" y="740" width="360" height="60" as="geometry"/>
        </mxCell>

        <!-- Payment adapter -->
        <mxCell id="act_payment_adapter" value="Payment Adapter: Route to MoMo/NFC/Card/PayPal/QR" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#d35400;fillColor=#fff5ec;" vertex="1" parent="lane_payment">
          <mxGeometry x="920" y="740" width="240" height="60" as="geometry"/>
        </mxCell>

        <!-- Example edges connecting key pieces (simplified sequence flows) -->
        <mxCell id="edge_req_to_auth" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="act_request_ride" target="act_authenticate">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_auth_to_match" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="act_authenticate" target="act_matchmaking">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_match_to_driver" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;html=1;" edge="1" parent="1" source="act_matchmaking" target="act_receive_request">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_driver_to_tracking" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="act_navigate_pickup" target="act_update_location">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_tracking_to_rider" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="act_update_location" target="act_view_driver">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_rider_to_payment" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="act_confirm_payment" target="act_payment_adapter">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_payment_to_messaging" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="act_payment_adapter" target="act_messaging">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <diagram id="ride_process_diag" name="ride_process.bpmn">
    <mxGraphModel dx="1000" dy="700" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Pool: Frontend Actors (Rider & Driver lanes) -->
        <mxCell id="pool_rp_frontend" value="Frontend Actors" style="swimlane;horizontal=0;startSize=30;rounded=0;fillColor=#ffffff;strokeColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="1000" height="360" as="geometry"/>
        </mxCell>

        <mxCell id="lane_rp_rider" value="Rider" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#7f8c8d;" vertex="1" parent="pool_rp_frontend">
          <mxGeometry x="0" y="0" width="1000" height="180" as="geometry"/>
        </mxCell>

        <mxCell id="lane_rp_driver" value="Driver" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#7f8c8d;" vertex="1" parent="pool_rp_frontend">
          <mxGeometry x="0" y="180" width="1000" height="180" as="geometry"/>
        </mxCell>

        <!-- Pool: Backend Services -->
        <mxCell id="pool_rp_backend" value="Backend Services" style="swimlane;horizontal=0;startSize=30;rounded=0;fillColor=#ffffff;strokeColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="20" y="400" width="1000" height="420" as="geometry"/>
        </mxCell>

        <!-- Backend lanes: Auth, Matchmaking, Tracking, Payment -->
        <mxCell id="lane_rp_auth" value="Auth / JWT" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_rp_backend">
          <mxGeometry x="0" y="0" width="1000" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="lane_rp_match" value="Matchmaking" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_rp_backend">
          <mxGeometry x="0" y="90" width="1000" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="lane_rp_tracking" value="Tracking" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_rp_backend">
          <mxGeometry x="0" y="200" width="1000" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="lane_rp_payment" value="Payment Adapter" style="swimlane;horizontal=1;startSize=36;rounded=0;fillColor=#ffffff;strokeColor=#95a5a6;" vertex="1" parent="pool_rp_backend">
          <mxGeometry x="0" y="310" width="1000" height="110" as="geometry"/>
        </mxCell>

        <!-- Rider activities (detailed, enterprise-level) -->
        <mxCell id="rp_act_validate" value="Validate Request (Address validation, fare estimate)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2c3e50;fillColor=#ecf0f1;" vertex="1" parent="lane_rp_rider">
          <mxGeometry x="40" y="40" width="320" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_send_request" value="Send Ride Request" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2c3e50;fillColor=#ecf0f1;" vertex="1" parent="lane_rp_rider">
          <mxGeometry x="380" y="40" width="240" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_wait_assignment" value="Waiting for Assignment / Timeout handling" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2c3e50;fillColor=#fcf8e3;" vertex="1" parent="lane_rp_rider">
          <mxGeometry x="660" y="40" width="280" height="60" as="geometry"/>
        </mxCell>

        <!-- Driver activities -->
        <mxCell id="rp_act_driver_notify" value="Driver: Notify & Offer (auto-expire)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#34495e;fillColor=#f6f8f9;" vertex="1" parent="lane_rp_driver">
          <mxGeometry x="40" y="220" width="320" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_driver_accept" value="Accept Ride / Reject (with reason)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#34495e;fillColor=#f6f8f9;" vertex="1" parent="lane_rp_driver">
          <mxGeometry x="380" y="220" width="240" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_pickup_arrival" value="Arrive at Pickup / Update Status" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#34495e;fillColor=#f6f8f9;" vertex="1" parent="lane_rp_driver">
          <mxGeometry x="660" y="220" width="280" height="60" as="geometry"/>
        </mxCell>

        <!-- Backend activities detailed -->
        <mxCell id="rp_act_issue_token" value="Issue/Refresh Daily JWT (device check)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#16a085;fillColor=#ecf9f7;" vertex="1" parent="lane_rp_auth">
          <mxGeometry x="40" y="430" width="320" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_choose_driver" value="Select Candidate Drivers (scoring, filters)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#27ae60;fillColor=#ecfaef;" vertex="1" parent="lane_rp_match">
          <mxGeometry x="380" y="430" width="360" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_track_updates" value="Consume GPS stream → Recompute ETA" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2980b9;fillColor=#eef6fb;" vertex="1" parent="lane_rp_tracking">
          <mxGeometry x="40" y="520" width="360" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="rp_act_process_payment" value="Process Payment (branch: MoMo/NFC/Card/QR/PayPal)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#d35400;fillColor=#fff5ec;" vertex="1" parent="lane_rp_payment">
          <mxGeometry x="420" y="520" width="420" height="60" as="geometry"/>
        </mxCell>

        <!-- Edges representing flows + exception handling -->
        <mxCell id="rp_edge_validate_to_send" edge="1" parent="1" source="rp_act_validate" target="rp_act_send_request" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>
        <mxCell id="rp_edge_send_to_match" edge="1" parent="1" source="rp_act_send_request" target="rp_act_choose_driver" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>
        <mxCell id="rp_edge_match_to_driver_notify" edge="1" parent="1" source="rp_act_choose_driver" target="rp_act_driver_notify" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>
        <mxCell id="rp_edge_driver_accept_to_pickup" edge="1" parent="1" source="rp_act_driver_accept" target="rp_act_pickup_arrival" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>
        <mxCell id="rp_edge_pickup_to_tracking" edge="1" parent="1" source="rp_act_pickup_arrival" target="rp_act_track_updates" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>
        <mxCell id="rp_edge_tracking_to_payment" edge="1" parent="1" source="rp_act_track_updates" target="rp_act_process_payment" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>

        <!-- Exception flows -->
        <mxCell id="rp_edge_timeout" edge="1" parent="1" source="rp_act_wait_assignment" target="rp_act_choose_driver" style="dashed=1;edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>
        <mxCell id="rp_edge_driver_reject" edge="1" parent="1" source="rp_act_driver_notify" target="rp_act_driver_accept" style="edgeStyle=orthogonalEdgeStyle;html=1;rounded=0;"/>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
